description:
    name: ppoaf_level_based_foraging
    description: LBF parameter study

batch:
    type: slurm
    host: pascal
    bank: aiwargm
    queue: pbatch

env:
    variables:
        OUTPUT_PATH: /p/lustre1/maguire7/ppoaf-study
        ENV_PATH: source /usr/workspace/maguire7/virtual_env/mat-dec/bin/activate
        RUNNER: /usr/workspace/wsb/maguire7/decsup/ppo_and_friends/baselines/gymnasium/level_based_foraging.py

generator.parameters:
    USE_ICM:
      values: [0, 1]
      label: ICM.%%
    TRIAL:
      values: [0]
      label: TRIAL.%%
    GRID_SIZE:
      values: [16]
      label: GRID_SIZE.%%
    TS_PER_ROLLOUT:
      values: [256]
      label: TS_PER_ROLLOUT.%%
    POLICY:
      values: ["mappo", "mat"]
      label: TS_PER_ROLLOUT.%%
    COOP:
      values: [0, 1]
      label: COOP.%%
    NUM_AGENTS:
      values: [3, 6]
      label: NUM_AGENTS.%%
    FOOD_COUNT:
      values: [2, 4]
      label: FOOD_COUNT.%%

study:
    - name: MAT_LBF
      description: Run an experiment with PPO-AF
      run:
          cmd: |
            source $(ENV_PATH)

            $(LAUNCHER) ppoaf train $(RUNNER) \
                --save_train_scores \
                --num_timesteps 20000000 \
                --random_seed $(TRIAL) \
                --grid_size $(GRID_SIZE) \
                --ts_per_rollout $(TS_PER_ROLLOUT) \
                --policy $(POLICY) \
                --use_icm $(USE_ICM) \
                --coop $(COOP) \
                --num_agents $(NUM_AGENTS) \
                --food_count $(FOOD_COUNT) \
                --state_tag grid_$(GRID_SIZE)-($TS_PER_ROLLOUT)_ts_per_rollout-$(POLICY)-$(COOP)_coop-$(NUM_AGENTS)_agents-$(FOOD_COUNT)_food-$(USE_ICM)_icm-seed_$(TRIAL)

          nodes: 1
          procs: 36
          exclusive: True
          walltime: "24:00:00"
